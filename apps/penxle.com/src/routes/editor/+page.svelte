<script lang="ts">
  import { Helmet } from '@penxle/ui';
  import { graphql } from '$glitch';
  import { BaseLayout } from '$lib/layouts';
  import Editor from './Editor.svelte';
  import Footer from './Footer.svelte';
  import Header from './Header.svelte';
  import type { Editor as TiptapEditor, JSONContent } from '@tiptap/core';
  import type { PostRevisionContentKind } from '$glitch';

  $: query = graphql(`
    query EditorPage_Query {
      ...BaseLayout_query
      ...EditorPage_Header_query
    }
  `);

  let kind: PostRevisionContentKind = 'ARTICLE';

  let title: string;
  let subtitle: string | null = null;
  let editor: TiptapEditor | undefined;
  let content: JSONContent | undefined;
  let tags: string[] = [];
  let thumbnailId: string | undefined = undefined;
  let thumbnailBounds: { top: number; left: number; width: number; height: number } | undefined = undefined;
</script>

<Helmet title="새 포스트 작성하기" />

<BaseLayout {$query}>
  <Header {$query} {content} {editor} {subtitle} {tags} {thumbnailBounds} {thumbnailId} {title} bind:kind />
  <Editor {kind} bind:title bind:editor bind:subtitle bind:content bind:thumbnailBounds bind:thumbnailId />
  <Footer {kind} bind:tags bind:content />
</BaseLayout>
